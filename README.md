# `.fits` plotting tools for ASTR 4998: Senior Thesis
This repository contains a set of tools I built for `.fits` data cube processing and visualization and CASA ADMIT line identification results parsing. It also contains a LaTex copy of my senior thesis as an Astronomy major (BA) at the University of Virginia. 

## Plot individual molecular lines from data packages generated by `ADMIT`
To plot individual molecular lines from an ADMIT data package (usually end with `.admit`), specify config information such as its location and name in `main.py` under `lineplot/`:
```
...
DATA_DIR = "/ASTR4998/data/raw"                 #parent directory        
PACKAGE_NAME = "SerpS_TC_spw0.fits.admit_BDP"   #data package name
CONFIG_NAME = "spw0"                #prefix of image generated
REST_FREQUENCY = 3.37061E+11        #rest frequency of .fits
MAX_Y = 60          #max peak / noise range in line plot generated by ADMIT
SAVEFIG = False     #save plots generated?
VPOS = 0.4          #scale factor of molecule formula insertion
VLSR = 8.0          #vlsr of .fits
...
```
For example, a `VPOS` of `0.4` will generate a plot with molecular name inserted as follow (at 0.4 of the plot's vertical height):

![line](/imgs/spw0_C17O.png)

Run the following command to plot individual molecular lines:
```
$ python3 lineplot/main.py
```

The plot will by default have `GHz` on x-axis and `peak/noise` ratio on y-axis




## Plot contour diagrams of `.fits` cube slice
To plot a contoured slice (i.e. one channel) of a `.fits` cube based on its background (noise) rms, specify config information in `main.py` under `cubeplot/`:

```
...
FITS_NAME = "SerpS_TC_spw3.fits"        #.fits file name
CUTOUT = 0                              #cutout size
CHANNELS = [932]                        #all channels to be plotted. list
CONTOUR_LEVELS = np.linspace(2, 60, 10) #contour levels 
BACKGROUND_CENTER = 90          #center pixel to measure background rms
BACKGROUND_SIZE = 10            #size of background measuring region
PREFIX = "spw0"                 #prefix of plots generated
SAVEFIG = True                  #save generated plots?
...
```
For example, a `100 x 100` image with `CUTOUT` set to `30` and `BACKGROUND_CENTER`, `BACKGROUND_SIZE` set to `90, 10` will have plot of size `40 x 40` cropped from center pixel of the slice and its background noise rms calculated based on pixel in the right corner square of size `20` 

Run the following command to plot cube slices
```
$ python3 cubeplot/main.py
```
Here is an example of how a plot may look like:

![slice](/imgs/spw3_932.png)

The plot will by default have right ascension on x-axis and declination on y-axis

## Latex generation
To generate Latex-compatible table of all identified lines (except for U-lines) from an ADMIT data package, specify config information in `main.py` under `latexgen/` as follow:

```
DATA_DIR = "/ASTR4998/data/raw"                 #parent directory
PACKAGE_NAME = "SerpS_TC_spw0.fits.admit_BDP"   #data package name
HEADER = ["Molecule", "Name", "Transition", "Frequency", "$E_{{u}}$", "Intensity", "Velocity", "$V_{{lsr}}$", "peak / rms"]
VLSR = 8.0
```